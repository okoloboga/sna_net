# JungAI Backend API

> **–°—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞:** –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω. –î–æ–±–∞–≤–ª–µ–Ω –ø–ª–∞–Ω –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –±—ç–∫–µ–Ω–¥–∞ –ø–æ–¥ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞.
>
> **–õ–µ–≥–µ–Ω–¥–∞:**
> - `[TODO]` ‚Äî –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å.
> - `[NEW]` ‚Äî –Ω–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –∏–ª–∏ —Å–µ–∫—Ü–∏—è.
> - `[REWORK]` ‚Äî —Å–µ–∫—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏.
> - `[DEPRECATED]` ‚Äî —ç–Ω–¥–ø–æ–∏–Ω—Ç —É—Å—Ç–∞—Ä–µ–ª –∏ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω/–∑–∞–º–µ–Ω–µ–Ω.
> - `[INFO]` ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **–ë–∞–∑–æ–≤—ã–π URL:** `http://{host}:{port}` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `http://localhost:8000`)
- **–í–µ—Ä—Å–∏—è API:** `v1`
- **–ü—Ä–µ—Ñ–∏–∫—Å –≤—Å–µ—Ö –±–∏–∑–Ω–µ—Å-—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:** `/api/v1`
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** JWT Bearer. –î–µ–π—Å—Ç–≤—É—é—â–∏–π `access_token` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`.
- –î–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è** (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∞–Ω–æ–Ω–∏–º–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏).

---

## –°–ª—É–∂–µ–±–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### GET `/`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ 200**
```json
{
  "service": "JungAI Backend API",
  "version": "1.0.0",
  "status": "running"
}
```

### GET `/health`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Health-check –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ 200**
```json
{
  "status": "ok",
  "service": "backend",
  "version": "1.0.0"
}
```

---

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º (`/api/v1/auth`)

### `[NEW]` POST `/api/v1/auth/anonymous`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–Ω–æ–Ω–∏–º–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ `device_id`.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "device_id": "uuid-string",
    "platform": "ios|android",
    "app_version": "1.0.0"
  }
  ```
- **–û—Ç–≤–µ—Ç 200:**
  ```json
  {
    "access_token": "jwt",
    "refresh_token": "jwt",
    "user": {
      "id": "uuid",
      "is_anonymous": true,
      "email": null
    }
  }
  ```

### `[NEW]` POST `/api/v1/auth/link`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–≤—è–∑–∫–∞ Google/Apple –∫ —Ç–µ–∫—É—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** —Ç—Ä–µ–±—É–µ—Ç—Å—è `access_token`.
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "provider": "google|apple",
    "id_token": "provider_id_token"
  }
  ```
- **–û—Ç–≤–µ—Ç 200:**
  ```json
  {
    "linked": true,
    "user": {
      "id": "uuid",
      "is_anonymous": false,
      "email": "user@email.com"
    },
    "provider_identity": {
      "provider": "google",
      "provider_subject": "xxxx",
      "email": "user@email.com"
    }
  }
  ```
- **–û—Å–Ω–æ–≤–Ω—ã–µ –æ—à–∏–±–∫–∏:**
  - `400` ‚Äî `invalid_provider`, `invalid_token`, `token_expired`, `audience_mismatch`.
  - `401` ‚Äî –Ω–µ—Ç/–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JWT.
  - `409` ‚Äî `identity_already_linked`, `user_already_has_identity`.

### POST `/api/v1/auth/register`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email/–ø–∞—Ä–æ–ª—é.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "email": "user@example.com",
    "password": "S3curePassw0rd",
    "first_name": "Carl",
    "last_name": "Jung",
    "timezone": "Europe/Moscow"
  }
  ```

**–û—Å–Ω–æ–≤–Ω—ã–µ –æ—à–∏–±–∫–∏**
- `400` ‚Äî email —É–∂–µ –∑–∞–Ω—è—Ç.
- `422` ‚Äî –ø–µ—Ä–µ–¥–∞–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `timezone` (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ IANA-–Ω–∞–∑–≤–∞–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä `Europe/Moscow` –∏–ª–∏ `UTC`).
- `500` ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

### POST `/api/v1/auth/login`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ email/–ø–∞—Ä–æ–ª—é.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

---

### POST `/api/v1/auth/refresh`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ refresh-token.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è refresh-token –≤ —Ç–µ–ª–µ.

---

### GET `/api/v1/auth/verify-email`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email –ø–æ —Ç–æ–∫–µ–Ω—É –∏–∑ –ø–∏—Å—å–º–∞.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:** `token` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π).

---

### POST `/api/v1/auth/resend-verification`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

---

### POST `/api/v1/auth/forgot-password`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–ø—Ä–æ—Å –Ω–∞ —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

---

### POST `/api/v1/auth/reset-password`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è –ø–æ —Ç–æ–∫–µ–Ω—É –∏–∑ –ø–∏—Å—å–º–∞.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

---

### DELETE `/api/v1/auth/account`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** —Ç—Ä–µ–±—É–µ—Ç—Å—è `access_token` (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–π email).

---

### POST `/api/v1/auth/logout`
- **`[INFO]`** –≠–Ω–¥–ø–æ–∏–Ω—Ç –Ω–µ –Ω–µ—Å–µ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–ª—å–∑—ã –ø—Ä–∏ stateless-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ. –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø—É—Ç–µ–º —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤.
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –õ–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (—Å–µ—Ä–≤–µ—Ä —Å—Ç–∞—Ç—É—Å–∞ —Ç–æ–∫–µ–Ω–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç).
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ.

---
## [NEW] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (`/api/v1/users`)

### GET `/api/v1/users/me`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** —Ç—Ä–µ–±—É–µ—Ç—Å—è `access_token`.
- **–û—Ç–≤–µ—Ç 200:**
  ```json
  {
    "id": "uuid",
    "email": "user@email.com",
    "is_anonymous": false,
    "linked_providers": ["google"],
    "profile": {
      "about_me": "..."
    }
  }
  ```

### PUT `/api/v1/users/me`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** —Ç—Ä–µ–±—É–µ—Ç—Å—è `access_token`.
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "timezone": "Europe/Zurich",
    "self_description": "–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ."
  }
  ```
- **–û—Ç–≤–µ—Ç 200:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## –°–Ω—ã (`/api/v1/dreams`)

### POST `/api/v1/dreams`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–Ω–∞.
- **–õ–∏–º–∏—Ç—ã:** –Ω–µ –±–æ–ª–µ–µ 5 –∑–∞–ø–∏—Å–µ–π –≤ —Å—É—Ç–∫–∏ (–ø–æ —á–∞—Å–æ–≤–æ–º—É –ø–æ—è—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "content": "–ú–Ω–µ —Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ —è –≥—É–ª—è—é –ø–æ —Ç—ë–º–Ω–æ–º—É —Å–æ—Å–Ω–æ–≤–æ–º—É –ª–µ—Å—É...",
    "title": "–°–æ–Ω –ø—Ä–æ –ª–µ—Å", // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    "emoji": "üå≤", // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    "comment": "–ü–æ–∫–∞–∑–∞–ª—Å—è –≤–∞–∂–Ω—ã–º" // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  }
  ```

**–û—Ç–≤–µ—Ç 201**
```json
{
  "id": "d2d39523-2f6a-46a8-a2c8-1a0e41285672",
  "user_id": "44cb8dca-4b02-425d-ba33-48423ab2fd0f",
  "title": "–°–æ–Ω –ø—Ä–æ –ª–µ—Å",
  "content": "–ú–Ω–µ —Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ —è –≥—É–ª—è—é –ø–æ —Ç—ë–º–Ω–æ–º—É —Å–æ—Å–Ω–æ–≤–æ–º—É –ª–µ—Å—É...",
  "emoji": "üå≤",
  "comment": "–ü–æ–∫–∞–∑–∞–ª—Å—è –≤–∞–∂–Ω—ã–º",
  "recorded_at": "2025-11-11T08:20:11.123Z",
  "created_at": "2025-11-11T08:20:11.123Z",
  "updated_at": "2025-11-11T08:20:11.123Z",
  "has_analysis": false
}
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –æ—à–∏–±–∫–∏**
- `429` ‚Äî –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç 5 —Å–Ω–æ–≤ –≤ —Å—É—Ç–∫–∏.

---

### GET `/api/v1/dreams`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–∞–≥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
  - `page` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `1`, `>=1`)
  - `page_size` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `10`, `1-100`)
  - `date` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, `YYYY-MM-DD`)

---

### GET `/api/v1/dreams/search`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É, –∑–∞–≥–æ–ª–æ–≤–∫—É –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—é.
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** `q` ‚Äî —Å—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è, –¥–ª–∏–Ω–∞ ‚â• 1).

---

### GET `/api/v1/dreams/{dream_id}`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–æ–Ω –ø–æ ID.

---

### PUT `/api/v1/dreams/{dream_id}`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π —Å–Ω–∞ (`title`, `content`, `emoji`, `comment`).

---

### DELETE `/api/v1/dreams/{dream_id}`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ —Å–Ω–∞ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## –ê–Ω–∞–ª–∏–∑—ã (`/api/v1/analyses`)

> **`[INFO]`** –í—Å—è —Å–µ–∫—Ü–∏—è –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–∏–∞–ª–æ–≥–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞. –í–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞ –±—É–¥–µ—Ç —á–∞—Ç.

### POST `/api/v1/analyses`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–ø—Ä–æ—Å–∏—Ç—å **–ø–µ—Ä–≤–∏—á–Ω—ã–π** –∞–Ω–∞–ª–∏–∑ –¥–ª—è —Å–Ω–∞. –û–¥–∏–Ω —Å–æ–Ω ‚Üí –æ–¥–∏–Ω –∞–Ω–∞–ª–∏–∑ (–æ–¥–Ω–∞ –∫–æ–º–Ω–∞—Ç–∞ —á–∞—Ç–∞).
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "dream_id": "d2d39523-2f6a-46a8-a2c8-1a0e41285672"
  }
  ```
- **–û—Ç–≤–µ—Ç 202:**
  ```json
  {
    "analysis_id": "d82d0a6f-8d1d-4af9-8d7d-4d8f99cd18f5", // ID –∫–æ–º–Ω–∞—Ç—ã —á–∞—Ç–∞
    "task_id": "5cfb22a6-4f38-4b6e-95b7-0e8dbe7d5a45",
    "status": "pending",
    "message": "Analysis task created. Use analysis_id to access the chat."
  }
  ```

---

### GET `/api/v1/analyses/dream/{dream_id}`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –ø–æ ID —Å–Ω–∞ (—Å—Ç–∞—Ç—É—Å/—Ä–µ–∑—É–ª—å—Ç–∞—Ç).
- **–û—Ç–≤–µ—Ç 200:**
  ```json
  {
    "id": "d82d0a6f-8d1d-4af9-8d7d-4d8f99cd18f5",
    "dream_id": "d2d39523-2f6a-46a8-a2c8-1a0e41285672",
    "status": "completed",
    "result": "–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–Ω–∞..."
  }
  ```

---

### GET `/api/v1/analyses/task/{task_id}`
- **`[INFO]`** –û—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ **–ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ** –∞–Ω–∞–ª–∏–∑–∞.
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Celery-–∑–∞–¥–∞—á–∏.

---
## `[NEW]` –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (`/api/v1/stats`)

### GET `/api/v1/stats/me`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** —Ç—Ä–µ–±—É–µ—Ç—Å—è `access_token`.
- **–û—Ç–≤–µ—Ç 200:**
  ```json
  {
    "total_dreams": 150,
    "streak_days": 14,
    "dreams_by_weekday": { "Mon": 20, "Tue": 25, "...": 0 },
    "avg_time_of_day": "23:30"
  }
  ```

---
## `[NEW]` –≠–∫—Å–ø–æ—Ä—Ç (`/api/v1/export`)

### `[TODO]` GET `/api/v1/export/json`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ JSON.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** —Ç—Ä–µ–±—É–µ—Ç—Å—è `access_token`.
- **–û—Ç–≤–µ—Ç 200:** `application/json` —Ñ–∞–π–ª.

### `[TODO]` GET `/api/v1/export/pdf`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Å–Ω–æ–≤ –≤ PDF.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** —Ç—Ä–µ–±—É–µ—Ç—Å—è `access_token`.
- **–û—Ç–≤–µ—Ç 200:** `application/pdf` —Ñ–∞–π–ª.

---

## –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏
- –í—Å–µ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤ JSON –∫–æ–¥–∏—Ä—É—é—Ç—Å—è –≤ UTF-8.
- –î–ª—è multipart-–∑–∞–≥—Ä—É–∑–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ MIME-—Ç–∏–ø—ã (`image/jpeg`, `image/png`).
- –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Celery —Å—Ç–∞—Ç—É—Å—ã –∑–∞–¥–∞—á —Ä–µ–≥–∏—Å—Ç—Ä–æ–∑–∞–≤–∏—Å–∏–º—ã ‚Äî –∫–ª–∏–µ–Ω—Ç—É —Å–ª–µ–¥—É–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å `PENDING`, `STARTED/PROCESSING`, `SUCCESS/COMPLETED`, `FAILURE/FAILED`.

---
## –ß–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ (`/api/v1/messages`)

### POST `/api/v1/messages`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–∏—Ç—å follow‚Äëup —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç –ø–æ —Å–Ω—É.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** —Ç—Ä–µ–±—É–µ—Ç—Å—è `access_token`.
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "dream_id": "d2d39523-2f6a-46a8-a2c8-1a0e41285672",
    "content": "–†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ –∞—Ä—Ö–µ—Ç–∏–ø —Ç–µ–Ω–∏."
  }
  ```
- **–û—Ç–≤–µ—Ç 202:**
  ```json
  {
    "task_id": "task-id",
    "status": "processing",
    "user_message": {
      "id": "msg-id",
      "dream_id": "d2d39523-2f6a-46a8-a2c8-1a0e41285672",
      "role": "user",
      "content": "–†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ –∞—Ä—Ö–µ—Ç–∏–ø —Ç–µ–Ω–∏.",
      "created_at": "2025-11-11T09:16:10.000Z"
    }
  }
  ```

### GET `/api/v1/messages/dream/{dream_id}`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ –ø–æ —Å–Ω—É.
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** `limit` (1-200), `offset` (>=0).
- **–û—Ç–≤–µ—Ç 200:**
  ```json
  {
    "messages": [
      {
        "id": "msg1",
        "dream_id": "d2d39523-2f6a-46a8-a2c8-1a0e41285672",
        "role": "assistant",
        "content": "–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–Ω–∞...",
        "created_at": "2025-11-11T08:25:45.012Z"
      }
    ],
    "total": 1
  }
  ```

### GET `/api/v1/messages/task/{task_id}`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞ LLM –¥–ª—è follow‚Äëup —Å–æ–æ–±—â–µ–Ω–∏–π.
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** —Ç—Ä–µ–±—É–µ—Ç—Å—è `access_token`.
- **–û—Ç–≤–µ—Ç 200:**
  ```json
  {
    "task_id": "task-id",
    "status": "PENDING|PROCESSING|SUCCESS|FAILURE",
    "result": "optional",
    "error": "optional"
  }
  ```

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Refresh-token —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (—Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –Ω–µ—Ç).
- –£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π (—Å–Ω—ã, –∞–Ω–∞–ª–∏–∑—ã, OAuth-–∞–∫–∫–∞—É–Ω—Ç—ã).
- –í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (URL –ë–î, –∫–ª—é—á–∏ JWT, SMTP –∏ —Ç.–¥.) –ø—Ä–∏—Ö–æ–¥—è—Ç –∏–∑ `.env` –∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º.
